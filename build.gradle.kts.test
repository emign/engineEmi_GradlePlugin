import java.net.*
import java.util.*
import java.io.*

buildscript {
    val kotlin_version: String by project
    repositories {
        mavenLocal()
        maven { url = uri("https://plugins.gradle.org/m2/") }
    }
    dependencies {
        classpath("com.gradle.publish:plugin-publish-plugin:0.10.1")
        classpath("org.jetbrains.kotlin.jvm:org.jetbrains.kotlin.jvm.gradle.plugin:$kotlin_version")
    }
}

plugins {
    id ("org.jetbrains.kotlin.jvm") version "$kotlin_version"
    id ("com.gradle.plugin-publish") version "0.10.1"
    id (java-gradle-plugin")
    id (maven-publish")
    id ("java")
}

val GROUP_ID: String by project
val ARTIFACT_ID: String by project
val BINTRAY_ORGANIZATION: String by project
val BINTRAY_REPOSITORY: String by project
val engineVersion: String by project
val korgeVersion: String by project
val kotlinVersion: String by project

group = GROUP_ID
version = version

repositories {
    maven {
        url = uri( "https://plugins.gradle.org/m2/")
    }
    maven { url = uri("https://dl.bintray.com/korlibs/korlibs") }
    mavenCentral()
    jcenter()
}

apply(plugin = "maven")
apply(plugin = "maven-publish")

pluginBundle {
    website = SITE_URL
    vcsUrl = VCS_URL
    tags = ['engineEmi', 'emig', 'engine', 'game engine', 'multiplatform', 'kotlin']

    plugins {
        engineEmi {
            id = "${GROUP_ID}.${ARTIFACT_ID}"
            displayName = ARTIFACT_ID
            description = 'Didactical Multiplatform Game Engine for Kotlin'
        }
    }
}

dependencies {
    api("com.soywiz.korlibs.korge.plugins:korge-gradle-plugin:$korgeVersion")
    api gradleApi()
    api localGroovy()
    implementation "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
    implementation "org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"
}